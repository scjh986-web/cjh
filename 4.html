<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>导弹发射模拟系统</title>
    <!-- Tailwind CSS v3 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <!-- 统一的 Tailwind 配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#0f172a',
                        secondary: '#1e293b',
                        accent: '#3b82f6',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        info: '#06b6d4',
                        dark: '#0f172a',
                        light: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'launch': 'launch 2s ease-out forwards',
                        'trail': 'trail 3s linear forwards',
                        'countdown': 'countdown 1s linear infinite',
                    },
                    keyframes: {
                        glow: {
                            '0%': { boxShadow: '0 0 5px rgba(59, 130, 246, 0.5)' },
                            '100%': { boxShadow: '0 0 20px rgba(59, 130, 246, 0.8), 0 0 30px rgba(59, 130, 246, 0.5)' }
                        },
                        launch: {
                            '0%': { transform: 'translateY(0)' },
                            '100%': { transform: 'translateY(-100vh)' }
                        },
                        trail: {
                            '0%': { opacity: 1 },
                            '100%': { opacity: 0 }
                        },
                        countdown: {
                            '0%': { transform: 'scale(1)', opacity: 1 },
                            '50%': { transform: 'scale(1.2)', opacity: 0.8 },
                            '100%': { transform: 'scale(1)', opacity: 1 }
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow {
                text-shadow: 0 0 10px rgba(59, 130, 246, 0.7);
            }
            .text-shadow-lg {
                text-shadow: 0 0 15px rgba(59, 130, 246, 0.9), 0 0 30px rgba(59, 130, 246, 0.6);
            }
            .bg-military {
                background: linear-gradient(to bottom, #0f172a, #1e293b);
            }
            .bg-panel {
                background: linear-gradient(to bottom, #1e293b, #0f172a);
            }
            .border-glow {
                box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
            }
            .border-glow-lg {
                box-shadow: 0 0 10px rgba(59, 130, 246, 0.7);
            }
            .grid-dashboard {
                display: grid;
                grid-template-columns: repeat(12, 1fr);
                grid-gap: 0.5rem;
            }
            .clip-path-polygon {
                clip-path: polygon(0 0, 100% 0, 95% 100%, 5% 100%);
            }
            .clip-path-hexagon {
                clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
            }
            .crt-effect {
                position: relative;
                overflow: hidden;
            }
            .crt-effect::before {
                content: "";
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: linear-gradient(
                    to bottom,
                    rgba(255, 255, 255, 0) 50%,
                    rgba(0, 0, 0, 0.2) 51%
                );
                background-size: 100% 4px;
                z-index: 10;
                pointer-events: none;
                animation: crt-flicker 0.15s infinite;
            }
            @keyframes crt-flicker {
                0% { opacity: 0.3; }
                50% { opacity: 0.5; }
                100% { opacity: 0.3; }
            }
            .scanline {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: linear-gradient(
                    to bottom,
                    transparent 50%,
                    rgba(0, 0, 0, 0.3) 51%
                );
                background-size: 100% 4px;
                z-index: 20;
                pointer-events: none;
                animation: scanline 8s linear infinite;
            }
            @keyframes scanline {
                0% { transform: translateY(-100%); }
                100% { transform: translateY(0); }
            }
            .missile {
                position: absolute;
                bottom: 0;
                left: 50%;
                transform: translateX(-50%);
                width: 40px;
                height: 150px;
                background: linear-gradient(to bottom, #6b7280, #9ca3af);
                border-radius: 20px 20px 0 0;
                z-index: 5;
                transition: transform 0.5s ease;
            }
            .missile::before {
                content: "";
                position: absolute;
                top: -10px;
                left: 50%;
                transform: translateX(-50%);
                width: 20px;
                height: 20px;
                background: linear-gradient(to bottom, #d1d5db, #f3f4f6);
                border-radius: 50%;
            }
            .missile::after {
                content: "";
                position: absolute;
                bottom: -20px;
                left: 50%;
                transform: translateX(-50%);
                width: 30px;
                height: 20px;
                background: linear-gradient(to bottom, #ef4444, #f87171);
                border-radius: 50%;
                box-shadow: 0 0 15px rgba(239, 68, 68, 0.8), 0 0 30px rgba(239, 68, 68, 0.5);
            }
            .flame {
                position: absolute;
                bottom: -30px;
                left: 50%;
                transform: translateX(-50%);
                width: 30px;
                height: 50px;
                background: linear-gradient(to bottom, #f59e0b, #ef4444);
                border-radius: 50% 50% 20% 20%;
                box-shadow: 0 0 20px rgba(245, 158, 11, 0.8), 0 0 40px rgba(239, 68, 68, 0.6);
                animation: flame-flicker 0.3s infinite alternate;
                z-index: 4;
            }
            @keyframes flame-flicker {
                0% { height: 40px; width: 25px; }
                100% { height: 60px; width: 35px; }
            }
            .trajectory {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 3;
                pointer-events: none;
            }
            .target {
                position: absolute;
                width: 20px;
                height: 20px;
                background: #ef4444;
                border-radius: 50%;
                box-shadow: 0 0 10px rgba(239, 68, 68, 0.8);
                z-index: 6;
                transform: translate(-50%, -50%);
            }
            .target::before {
                content: "";
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 30px;
                height: 30px;
                border: 2px solid #ef4444;
                border-radius: 50%;
                animation: target-pulse 1s infinite;
            }
            @keyframes target-pulse {
                0% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
                100% { transform: translate(-50%, -50%) scale(1.5); opacity: 0; }
            }
            .radar {
                position: relative;
                width: 100%;
                height: 100%;
                border-radius: 50%;
                background: radial-gradient(circle, rgba(59, 130, 246, 0.2) 0%, rgba(15, 23, 42, 0) 70%);
                overflow: hidden;
            }
            .radar::before {
                content: "";
                position: absolute;
                top: 0;
                left: 50%;
                width: 50%;
                height: 50%;
                background: linear-gradient(45deg, rgba(59, 130, 246, 0.3) 0%, rgba(59, 130, 246, 0) 100%);
                transform-origin: bottom left;
                animation: radar-sweep 4s linear infinite;
            }
            @keyframes radar-sweep {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            .radar-blip {
                position: absolute;
                width: 8px;
                height: 8px;
                background: #10b981;
                border-radius: 50%;
                box-shadow: 0 0 8px rgba(16, 185, 129, 0.8);
                transform: translate(-50%, -50%);
                z-index: 2;
            }
            .parameter-value {
                font-variant-numeric: tabular-nums;
                font-feature-settings: 'tnum';
            }
            .toggle-switch {
                position: relative;
                display: inline-block;
                width: 50px;
                height: 24px;
            }
            .toggle-switch input {
                opacity: 0;
                width: 0;
                height: 0;
            }
            .toggle-slider {
                position: absolute;
                cursor: pointer;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background-color: #374151;
                transition: .4s;
                border-radius: 24px;
            }
            .toggle-slider:before {
                position: absolute;
                content: "";
                height: 18px;
                width: 18px;
                left: 3px;
                bottom: 3px;
                background-color: white;
                transition: .4s;
                border-radius: 50%;
            }
            input:checked + .toggle-slider {
                background-color: #3b82f6;
            }
            input:checked + .toggle-slider:before {
                transform: translateX(26px);
            }
            .button-3d {
                position: relative;
                transition: all 0.2s ease;
                transform-style: preserve-3d;
            }
            .button-3d:before {
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                left: 0;
                bottom: -4px;
                background-color: rgba(0, 0, 0, 0.3);
                transform: translateZ(-1px);
                border-radius: inherit;
            }
            .button-3d:active {
                transform: translateY(2px);
            }
            .button-3d:active:before {
                bottom: -2px;
            }
            .display-digit {
                position: relative;
                display: inline-block;
                width: 20px;
                height: 35px;
                margin: 0 2px;
            }
            .display-digit-segment {
                position: absolute;
                width: 100%;
                height: 4px;
                background-color: #374151;
                border-radius: 2px;
                transition: background-color 0.3s ease;
            }
            .display-digit.active .display-digit-segment {
                background-color: #ef4444;
                box-shadow: 0 0 5px rgba(239, 68, 68, 0.8);
            }
            .display-digit-segment.a { top: 0; left: 0; }
            .display-digit-segment.b { top: 5px; right: 0; width: 4px; height: calc(50% - 5px); }
            .display-digit-segment.c { bottom: 5px; right: 0; width: 4px; height: calc(50% - 5px); }
            .display-digit-segment.d { bottom: 0; left: 0; }
            .display-digit-segment.e { bottom: 5px; left: 0; width: 4px; height: calc(50% - 5px); }
            .display-digit-segment.f { top: 5px; left: 0; width: 4px; height: calc(50% - 5px); }
            .display-digit-segment.g { top: 50%; left: 0; transform: translateY(-50%); }
            .display-digit-0 .a,
            .display-digit-0 .b,
            .display-digit-0 .c,
            .display-digit-0 .d,
            .display-digit-0 .e,
            .display-digit-0 .f { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-1 .b,
            .display-digit-1 .c { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-2 .a,
            .display-digit-2 .b,
            .display-digit-2 .g,
            .display-digit-2 .e,
            .display-digit-2 .d { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-3 .a,
            .display-digit-3 .b,
            .display-digit-3 .g,
            .display-digit-3 .c,
            .display-digit-3 .d { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-4 .f,
            .display-digit-4 .g,
            .display-digit-4 .b,
            .display-digit-4 .c { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-5 .a,
            .display-digit-5 .f,
            .display-digit-5 .g,
            .display-digit-5 .c,
            .display-digit-5 .d { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-6 .a,
            .display-digit-6 .f,
            .display-digit-6 .g,
            .display-digit-6 .c,
            .display-digit-6 .d,
            .display-digit-6 .e { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-7 .a,
            .display-digit-7 .b,
            .display-digit-7 .c { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-8 .a,
            .display-digit-8 .b,
            .display-digit-8 .c,
            .display-digit-8 .d,
            .display-digit-8 .e,
            .display-digit-8 .f,
            .display-digit-8 .g { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
            
            .display-digit-9 .a,
            .display-digit-9 .b,
            .display-digit-9 .c,
            .display-digit-9 .d,
            .display-digit-9 .f,
            .display-digit-9 .g { background-color: #ef4444; box-shadow: 0 0 5px rgba(239, 68, 68, 0.8); }
        }
    </style>
</head>
<body class="bg-military text-light min-h-screen overflow-x-hidden">
    <!-- 顶部导航栏 -->
    <header class="bg-secondary border-b border-accent/30 shadow-lg">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fa fa-rocket text-accent text-2xl animate-pulse-slow"></i>
                <h1 class="text-xl font-bold text-shadow">导弹发射模拟系统</h1>
            </div>
            <div class="flex items-center space-x-6">
                <div class="flex items-center space-x-2">
                    <span class="text-sm text-gray-400">系统状态:</span>
                    <span class="text-sm font-medium text-success flex items-center">
                        <span class="inline-block w-2 h-2 bg-success rounded-full mr-1 animate-pulse"></span>
                        在线
                    </span>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="text-sm text-gray-400">模式:</span>
                    <select id="operation-mode" class="bg-dark border border-accent/30 rounded px-2 py-1 text-sm focus:outline-none focus:border-accent">
                        <option value="simulation">模拟模式</option>
                        <option value="training">训练模式</option>
                        <option value="test">测试模式</option>
                    </select>
                </div>
                <button id="help-button" class="bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1 rounded text-sm transition-colors flex items-center">
                    <i class="fa fa-question-circle mr-1"></i> 帮助
                </button>
            </div>
        </div>
    </header>

    <!-- 主内容区 -->
    <main class="container mx-auto px-4 py-6">
        <!-- 系统状态概览 -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-panel rounded-lg p-3 border border-accent/30 border-glow">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-sm text-gray-400">导弹状态</h3>
                    <span id="missile-status" class="text-xs px-2 py-0.5 rounded-full bg-success/20 text-success">就绪</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-missile text-accent mr-2"></i>
                    <span id="missile-type" class="font-medium">东风-41 洲际弹道导弹</span>
                </div>
            </div>
            <div class="bg-panel rounded-lg p-3 border border-accent/30 border-glow">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-sm text-gray-400">发射位置</h3>
                    <span class="text-xs px-2 py-0.5 rounded-full bg-info/20 text-info">已定位</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-map-marker text-accent mr-2"></i>
                    <span id="launch-position" class="font-medium">北纬 40.7128° 东经 116.4074°</span>
                </div>
            </div>
            <div class="bg-panel rounded-lg p-3 border border-accent/30 border-glow">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-sm text-gray-400">目标位置</h3>
                    <span id="target-status" class="text-xs px-2 py-0.5 rounded-full bg-info/20 text-info">已锁定</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-crosshairs text-accent mr-2"></i>
                    <span id="target-position" class="font-medium">北纬 35.6762° 东经 139.6503°</span>
                </div>
            </div>
            <div class="bg-panel rounded-lg p-3 border border-accent/30 border-glow">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="text-sm text-gray-400">系统时间</h3>
                    <span class="text-xs px-2 py-0.5 rounded-full bg-dark text-gray-300">实时</span>
                </div>
                <div class="flex items-center">
                    <i class="fa fa-clock-o text-accent mr-2"></i>
                    <span id="system-time" class="font-medium">2025-10-31 15:30:45</span>
                </div>
            </div>
        </div>

        <!-- 主要工作区 -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- 左侧控制面板 -->
            <div class="lg:col-span-1 space-y-6">
                <!-- 环境参数设置 -->
                <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-shadow flex items-center">
                            <i class="fa fa-cloud mr-2 text-accent"></i> 环境参数设置
                        </h2>
                        <button id="reset-environment" class="text-xs bg-accent/20 hover:bg-accent/30 text-accent px-2 py-1 rounded transition-colors">
                            重置
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- 地形类型 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">地形类型</label>
                                <span id="terrain-value" class="text-sm font-medium parameter-value">平原</span>
                            </div>
                            <select id="terrain-type" class="w-full bg-dark border border-accent/30 rounded px-3 py-2 focus:outline-none focus:border-accent">
                                <option value="plain">平原</option>
                                <option value="mountain">山地</option>
                                <option value="desert">沙漠</option>
                                <option value="ocean">海洋</option>
                                <option value="forest">森林</option>
                            </select>
                        </div>
                        
                        <!-- 海拔高度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">海拔高度 (米)</label>
                                <span id="elevation-value" class="text-sm font-medium parameter-value">500</span>
                            </div>
                            <input type="range" id="elevation" min="0" max="5000" value="500" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 风速 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">风速 (米/秒)</label>
                                <span id="wind-speed-value" class="text-sm font-medium parameter-value">5</span>
                            </div>
                            <input type="range" id="wind-speed" min="0" max="30" value="5" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 风向 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">风向 (度)</label>
                                <span id="wind-direction-value" class="text-sm font-medium parameter-value">90</span>
                            </div>
                            <input type="range" id="wind-direction" min="0" max="360" value="90" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 温度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">温度 (°C)</label>
                                <span id="temperature-value" class="text-sm font-medium parameter-value">25</span>
                            </div>
                            <input type="range" id="temperature" min="-40" max="50" value="25" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 湿度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">湿度 (%)</label>
                                <span id="humidity-value" class="text-sm font-medium parameter-value">50</span>
                            </div>
                            <input type="range" id="humidity" min="0" max="100" value="50" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                    </div>
                </div>
                
                <!-- 目标参数设置 -->
                <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-shadow flex items-center">
                            <i class="fa fa-crosshairs mr-2 text-accent"></i> 目标参数设置
                        </h2>
                        <button id="reset-target" class="text-xs bg-accent/20 hover:bg-accent/30 text-accent px-2 py-1 rounded transition-colors">
                            重置
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- 目标类型 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">目标类型</label>
                                <span id="target-type-value" class="text-sm font-medium parameter-value">固定目标</span>
                            </div>
                            <select id="target-type" class="w-full bg-dark border border-accent/30 rounded px-3 py-2 focus:outline-none focus:border-accent">
                                <option value="fixed">固定目标</option>
                                <option value="moving">移动目标</option>
                                <option value="high-value">高价值目标</option>
                                <option value="area">区域目标</option>
                            </select>
                        </div>
                        
                        <!-- 目标纬度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">目标纬度 (°)</label>
                                <span id="target-latitude-value" class="text-sm font-medium parameter-value">35.6762</span>
                            </div>
                            <input type="range" id="target-latitude" min="-90" max="90" value="35.6762" step="0.0001" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 目标经度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">目标经度 (°)</label>
                                <span id="target-longitude-value" class="text-sm font-medium parameter-value">139.6503</span>
                            </div>
                            <input type="range" id="target-longitude" min="-180" max="180" value="139.6503" step="0.0001" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 目标海拔 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">目标海拔 (米)</label>
                                <span id="target-elevation-value" class="text-sm font-medium parameter-value">100</span>
                            </div>
                            <input type="range" id="target-elevation" min="-1000" max="8000" value="100" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 目标移动速度 (仅当目标类型为移动目标时显示) -->
                        <div id="target-speed-container" class="hidden">
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">移动速度 (米/秒)</label>
                                <span id="target-speed-value" class="text-sm font-medium parameter-value">20</span>
                            </div>
                            <input type="range" id="target-speed" min="0" max="100" value="20" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 目标移动方向 (仅当目标类型为移动目标时显示) -->
                        <div id="target-direction-container" class="hidden">
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">移动方向 (度)</label>
                                <span id="target-direction-value" class="text-sm font-medium parameter-value">45</span>
                            </div>
                            <input type="range" id="target-direction" min="0" max="360" value="45" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                    </div>
                </div>
                
                <!-- 导弹参数设置 -->
                <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-shadow flex items-center">
                            <i class="fa fa-missile mr-2 text-accent"></i> 导弹参数设置
                        </h2>
                        <button id="reset-missile" class="text-xs bg-accent/20 hover:bg-accent/30 text-accent px-2 py-1 rounded transition-colors">
                            重置
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <!-- 导弹类型 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">导弹类型</label>
                                <span id="missile-type-value" class="text-sm font-medium parameter-value">东风-41</span>
                            </div>
                            <select id="missile-type-select" class="w-full bg-dark border border-accent/30 rounded px-3 py-2 focus:outline-none focus:border-accent">
                                <option value="df-41">东风-41 洲际弹道导弹</option>
                                <option value="df-31">东风-31 洲际弹道导弹</option>
                                <option value="df-26">东风-26 中远程弹道导弹</option>
                                <option value="df-17">东风-17 高超音速导弹</option>
                                <option value="cj-10">长剑-10 巡航导弹</option>
                            </select>
                        </div>
                        
                        <!-- 弹头类型 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">弹头类型</label>
                                <span id="warhead-type-value" class="text-sm font-medium parameter-value">核弹头</span>
                            </div>
                            <select id="warhead-type" class="w-full bg-dark border border-accent/30 rounded px-3 py-2 focus:outline-none focus:border-accent">
                                <option value="nuclear">核弹头</option>
                                <option value="conventional">常规弹头</option>
                                <option value="thermobaric">温压弹头</option>
                                <option value="cluster">集束弹头</option>
                            </select>
                        </div>
                        
                        <!-- 发射角度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">发射角度 (度)</label>
                                <span id="launch-angle-value" class="text-sm font-medium parameter-value">45</span>
                            </div>
                            <input type="range" id="launch-angle" min="0" max="90" value="45" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                        
                        <!-- 初始速度 -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-sm text-gray-400">初始速度 (米/秒)</label>
                                <span id="initial-speed-value" class="text-sm font-medium parameter-value">7000</span>
                            </div>
                            <input type="range" id="initial-speed" min="1000" max="10000" value="7000" class="w-full h-2 bg-dark rounded-lg appearance-none cursor-pointer accent-accent">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 中间和右侧区域 -->
            <div class="lg:col-span-2 space-y-6">
                <!-- 导弹发射模拟区域 -->
                <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow relative overflow-hidden crt-effect">
                    <div class="scanline"></div>
                    <div class="flex justify-between items-center mb-4 relative z-10">
                        <h2 class="text-lg font-semibold text-shadow flex items-center">
                            <i class="fa fa-play-circle mr-2 text-accent"></i> 导弹发射模拟
                        </h2>
                        <div class="flex space-x-2">
                            <button id="calculate-trajectory" class="bg-info/20 hover:bg-info/30 text-info px-3 py-1 rounded text-sm transition-colors flex items-center">
                                <i class="fa fa-calculator mr-1"></i> 计算弹道
                            </button>
                            <button id="clear-simulation" class="bg-warning/20 hover:bg-warning/30 text-warning px-3 py-1 rounded text-sm transition-colors flex items-center">
                                <i class="fa fa-refresh mr-1"></i> 重置模拟
                            </button>
                        </div>
                    </div>
                    
                    <!-- 模拟区域 -->
                    <div id="simulation-area" class="relative h-96 bg-primary rounded-lg overflow-hidden border border-accent/20">
                        <!-- 导弹 -->
                        <div id="missile" class="missile hidden">
                            <div id="flame" class="flame hidden"></div>
                        </div>
                        
                        <!-- 轨迹 -->
                        <div id="trajectory" class="trajectory"></div>
                        
                        <!-- 目标 -->
                        <div id="target" class="target hidden"></div>
                        
                        <!-- 背景元素 -->
                        <div class="absolute bottom-0 left-0 w-full h-16 bg-gradient-to-t from-gray-800 to-transparent"></div>
                        <div class="absolute top-0 left-0 w-full h-full bg-[url('https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/9c89f6d62ddf48db81e6379726fb1b2b~tplv-a9rns2rl98-image.image?rcl=2025103111303670B165368D1F97217B6D&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1764473485&x-signature=f5TVy9Ul%2BoKERALEe5BGeuHc8eY%3D')] bg-cover bg-center opacity-20"></div>
                    </div>
                    
                    <!-- 发射控制面板 -->
                    <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4 relative z-10">
                        <!-- 倒计时显示 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30 flex flex-col items-center justify-center">
                            <h3 class="text-sm text-gray-400 mb-2">发射倒计时</h3>
                            <div id="countdown-display" class="flex items-center space-x-1">
                                <div class="display-digit display-digit-0">
                                    <div class="display-digit-segment a"></div>
                                    <div class="display-digit-segment b"></div>
                                    <div class="display-digit-segment c"></div>
                                    <div class="display-digit-segment d"></div>
                                    <div class="display-digit-segment e"></div>
                                    <div class="display-digit-segment f"></div>
                                    <div class="display-digit-segment g"></div>
                                </div>
                                <div class="text-accent font-bold">:</div>
                                <div class="display-digit display-digit-0">
                                    <div class="display-digit-segment a"></div>
                                    <div class="display-digit-segment b"></div>
                                    <div class="display-digit-segment c"></div>
                                    <div class="display-digit-segment d"></div>
                                    <div class="display-digit-segment e"></div>
                                    <div class="display-digit-segment f"></div>
                                    <div class="display-digit-segment g"></div>
                                </div>
                                <div class="text-accent font-bold">:</div>
                                <div class="display-digit display-digit-0">
                                    <div class="display-digit-segment a"></div>
                                    <div class="display-digit-segment b"></div>
                                    <div class="display-digit-segment c"></div>
                                    <div class="display-digit-segment d"></div>
                                    <div class="display-digit-segment e"></div>
                                    <div class="display-digit-segment f"></div>
                                    <div class="display-digit-segment g"></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 发射控制 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30 flex flex-col items-center justify-center">
                            <h3 class="text-sm text-gray-400 mb-2">发射控制</h3>
                            <div class="flex flex-col space-y-2 w-full">
                                <button id="arm-missile" class="bg-warning/20 hover:bg-warning/30 text-warning px-4 py-2 rounded transition-colors button-3d">
                                    <i class="fa fa-lock mr-1"></i> 武器解除保险
                                </button>
                                <button id="launch-missile" class="bg-danger/20 hover:bg-danger/30 text-danger px-4 py-2 rounded transition-colors button-3d disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                                    <i class="fa fa-rocket mr-1"></i> 发射导弹
                                </button>
                            </div>
                        </div>
                        
                        <!-- 发射状态 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30 flex flex-col items-center justify-center">
                            <h3 class="text-sm text-gray-400 mb-2">发射状态</h3>
                            <div id="launch-status" class="text-center">
                                <div class="w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center mb-2">
                                    <i id="status-icon" class="fa fa-check-circle text-2xl text-gray-500"></i>
                                </div>
                                <p id="status-text" class="text-sm font-medium">等待发射指令</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 数据可视化区域 -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- 弹道轨迹图表 -->
                    <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-semibold text-shadow flex items-center">
                                <i class="fa fa-line-chart mr-2 text-accent"></i> 弹道轨迹图表
                            </h2>
                            <div class="flex space-x-2">
                                <button id="show-altitude" class="bg-info/20 hover:bg-info/30 text-info px-2 py-1 rounded text-xs transition-colors">
                                    高度
                                </button>
                                <button id="show-distance" class="bg-dark hover:bg-dark/80 text-gray-300 px-2 py-1 rounded text-xs transition-colors">
                                    距离
                                </button>
                            </div>
                        </div>
                        <div class="h-64">
                            <canvas id="trajectory-chart"></canvas>
                        </div>
                    </div>
                    
                    <!-- 雷达显示 -->
                    <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-lg font-semibold text-shadow flex items-center">
                                <i class="fa fa-satellite-dish mr-2 text-accent"></i> 雷达显示
                            </h2>
                            <div class="flex items-center space-x-2">
                                <span class="text-xs text-gray-400">扫描模式:</span>
                                <select id="radar-mode" class="bg-dark border border-accent/30 rounded px-2 py-0.5 text-xs focus:outline-none focus:border-accent">
                                    <option value="active">主动扫描</option>
                                    <option value="passive">被动扫描</option>
                                </select>
                            </div>
                        </div>
                        <div class="h-64 relative">
                            <div class="radar w-full h-full"></div>
                            <div id="radar-target" class="radar-blip hidden" style="top: 30%; left: 70%;"></div>
                            <div id="radar-missile" class="radar-blip hidden" style="top: 50%; left: 50%; background-color: #3b82f6;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- 数据分析区域 -->
                <div class="bg-panel rounded-lg p-4 border border-accent/30 border-glow">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-semibold text-shadow flex items-center">
                            <i class="fa fa-bar-chart mr-2 text-accent"></i> 数据分析
                        </h2>
                        <button id="generate-report" class="bg-info/20 hover:bg-info/30 text-info px-3 py-1 rounded text-sm transition-colors flex items-center">
                            <i class="fa fa-file-text mr-1"></i> 生成报告
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <!-- 飞行时间 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30">
                            <h3 class="text-sm text-gray-400 mb-1">预计飞行时间</h3>
                            <p id="flight-time" class="text-xl font-bold text-accent parameter-value">00:00:00</p>
                        </div>
                        
                        <!-- 最大高度 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30">
                            <h3 class="text-sm text-gray-400 mb-1">预计最大高度</h3>
                            <p id="max-altitude" class="text-xl font-bold text-accent parameter-value">0 km</p>
                        </div>
                        
                        <!-- 射程 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30">
                            <h3 class="text-sm text-gray-400 mb-1">预计射程</h3>
                            <p id="range" class="text-xl font-bold text-accent parameter-value">0 km</p>
                        </div>
                        
                        <!-- 命中率 -->
                        <div class="bg-dark rounded-lg p-3 border border-accent/30">
                            <h3 class="text-sm text-gray-400 mb-1">预计命中率</h3>
                            <p id="hit-probability" class="text-xl font-bold text-success parameter-value">0%</p>
                        </div>
                    </div>
                    
                    <!-- 参数影响分析 -->
                    <div class="mt-4">
                        <h3 class="text-sm text-gray-400 mb-2">参数影响分析</h3>
                        <div class="h-48">
                            <canvas id="impact-chart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 底部状态栏 -->
    <footer class="bg-secondary border-t border-accent/30 py-3 mt-6">
        <div class="container mx-auto px-4 flex justify-between items-center">
            <div class="text-sm text-gray-400">
                <span>导弹发射模拟系统 v1.0.0</span>
                <span class="mx-2">|</span>
                <span>© 2025 军事模拟技术</span>
            </div>
            <div class="flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <span class="text-xs text-gray-400">系统负载:</span>
                    <div class="w-24 h-2 bg-dark rounded-full overflow-hidden">
                        <div id="system-load" class="h-full bg-success" style="width: 25%"></div>
                    </div>
                    <span id="load-percentage" class="text-xs">25%</span>
                </div>
                <div class="flex items-center space-x-2">
                    <span class="text-xs text-gray-400">连接状态:</span>
                    <span class="text-xs font-medium text-success flex items-center">
                        <span class="inline-block w-2 h-2 bg-success rounded-full mr-1"></span>
                        已连接
                    </span>
                </div>
            </div>
        </div>
    </footer>

    <!-- 帮助模态框 -->
    <div id="help-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
        <div class="bg-panel rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto border border-accent/30 border-glow-lg">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-shadow">系统使用帮助</h2>
                <button id="close-help" class="text-gray-400 hover:text-white">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <h3 class="text-lg font-semibold text-accent mb-2">系统概述</h3>
                    <p class="text-gray-300">导弹发射模拟系统是一个高度逼真的军事模拟平台，用于模拟导弹发射过程中的各种因素和操作流程。系统考虑了地形、气象、海拔等多种因素对导弹发射的影响，提供了直观的可视化界面和数据分析功能。</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-accent mb-2">基本操作流程</h3>
                    <ol class="list-decimal list-inside space-y-2 text-gray-300">
                        <li>设置环境参数（地形、海拔、气象等）</li>
                        <li>设置目标参数（类型、坐标、移动速度等）</li>
                        <li>选择导弹类型和参数</li>
                        <li>点击"计算弹道"按钮进行弹道计算</li>
                        <li>点击"武器解除保险"按钮解除武器保险</li>
                        <li>点击"发射导弹"按钮启动发射程序</li>
                    </ol>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-accent mb-2">参数说明</h3>
                    <div class="space-y-3">
                        <div>
                            <h4 class="font-medium text-white">环境参数</h4>
                            <ul class="list-disc list-inside text-gray-300 text-sm">
                                <li>地形类型：影响导弹发射的初始条件和飞行路径</li>
                                <li>海拔高度：影响空气密度和压力，从而影响导弹飞行</li>
                                <li>风速和风向：对导弹飞行轨迹产生侧向力</li>
                                <li>温度和湿度：影响空气密度和导弹材料性能</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-white">目标参数</h4>
                            <ul class="list-disc list-inside text-gray-300 text-sm">
                                <li>目标类型：固定目标、移动目标、高价值目标或区域目标</li>
                                <li>目标坐标：目标的经纬度和海拔高度</li>
                                <li>移动速度和方向：仅对移动目标有效</li>
                            </ul>
                        </div>
                        
                        <div>
                            <h4 class="font-medium text-white">导弹参数</h4>
                            <ul class="list-disc list-inside text-gray-300 text-sm">
                                <li>导弹类型：不同类型导弹具有不同的性能参数</li>
                                <li>弹头类型：核弹头、常规弹头、温压弹头或集束弹头</li>
                                <li>发射角度：影响导弹的初始弹道方向</li>
                                <li>初始速度：导弹发射时的初始速度</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-accent mb-2">数据分析</h3>
                    <p class="text-gray-300">系统提供了多种数据分析功能，包括弹道轨迹图表、雷达显示和参数影响分析。用户可以通过这些功能直观地了解各种参数对导弹发射的影响，以及预测导弹的飞行轨迹和命中概率。</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-accent mb-2">注意事项</h3>
                    <ul class="list-disc list-inside space-y-1 text-gray-300">
                        <li>本系统仅用于模拟和训练目的，不得用于实际军事行动</li>
                        <li>在进行模拟前，请确保所有参数设置正确</li>
                        <li>系统默认使用公制单位（米、秒、摄氏度等）</li>
                        <li>如遇到系统问题，请联系技术支持</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- 报告模态框 -->
    <div id="report-modal" class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 hidden">
        <div class="bg-panel rounded-lg p-6 max-w-4xl w-full max-h-[80vh] overflow-y-auto border border-accent/30 border-glow-lg">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-xl font-bold text-shadow">导弹发射模拟报告</h2>
                <button id="close-report" class="text-gray-400 hover:text-white">
                    <i class="fa fa-times text-xl"></i>
                </button>
            </div>
            
            <div id="report-content" class="space-y-4">
                <!-- 报告内容将通过JavaScript动态生成 -->
            </div>
            
            <div class="mt-6 flex justify-end space-x-3">
                <button id="print-report" class="bg-info/20 hover:bg-info/30 text-info px-4 py-2 rounded transition-colors flex items-center">
                    <i class="fa fa-print mr-1"></i> 打印报告
                </button>
                <button id="download-report" class="bg-success/20 hover:bg-success/30 text-success px-4 py-2 rounded transition-colors flex items-center">
                    <i class="fa fa-download mr-1"></i> 下载报告
                </button>
            </div>
        </div>
    </div>

    <script>
        // 系统数据模型
        const systemData = {
            // 环境参数
            environment: {
                terrain: 'plain',
                elevation: 500,
                windSpeed: 5,
                windDirection: 90,
                temperature: 25,
                humidity: 50
            },
            
            // 目标参数
            target: {
                type: 'fixed',
                coordinates: {
                    latitude: 35.6762,
                    longitude: 139.6503,
                    elevation: 100
                },
                movement: {
                    speed: 20,
                    direction: 45
                }
            },
            
            // 导弹参数
            missile: {
                type: 'df-41',
                typeName: '东风-41 洲际弹道导弹',
                warhead: 'nuclear',
                launchAngle: 45,
                initialSpeed: 7000,
                specifications: {
                    'df-41': {
                        range: 14000,
                        speed: 7000,
                        accuracy: 100,
                        warheadTypes: ['nuclear', 'conventional'],
                        description: '东风-41是中国自主研发的洲际弹道导弹，具有射程远、精度高、突防能力强等特点。'
                    },
                    'df-31': {
                        range: 8000,
                        speed: 6500,
                        accuracy: 150,
                        warheadTypes: ['nuclear', 'conventional'],
                        description: '东风-31是中国自主研发的洲际弹道导弹，具有机动性好、生存能力强等特点。'
                    },
                    'df-26': {
                        range: 4000,
                        speed: 5500,
                        accuracy: 50,
                        warheadTypes: ['nuclear', 'conventional', 'thermobaric'],
                        description: '东风-26是中国自主研发的中远程弹道导弹，具有反舰、对地攻击等多种能力。'
                    },
                    'df-17': {
                        range: 2000,
                        speed: 8000,
                        accuracy: 10,
                        warheadTypes: ['conventional', 'thermobaric'],
                        description: '东风-17是中国自主研发的高超音速导弹，具有高机动性、难以拦截等特点。'
                    },
                    'cj-10': {
                        range: 2500,
                        speed: 3000,
                        accuracy: 5,
                        warheadTypes: ['conventional', 'cluster'],
                        description: '长剑-10是中国自主研发的巡航导弹，具有精度高、突防能力强等特点。'
                    }
                }
            },
            
            // 发射参数
            launch: {
                position: {
                    latitude: 40.7128,
                    longitude: 116.4074
                },
                status: 'ready', // ready, armed, launching, launched, completed, failed
                countdown: 10,
                isCountingDown: false,
                countdownInterval: null,
                trajectoryCalculated: false,
                simulationRunning: false
            },
            
            // 模拟数据
            simulation: {
                flightTime: 0,
                maxAltitude: 0,
                range: 0,
                hitProbability: 0,
                trajectoryPoints: [],
                impactPoint: null
            },
            
            // 系统状态
            system: {
                time: new Date(),
                load: 25,
                mode: 'simulation' // simulation, training, test
            }
        };

        // DOM 元素
        const elements = {
            // 环境参数
            terrainType: document.getElementById('terrain-type'),
            terrainValue: document.getElementById('terrain-value'),
            elevation: document.getElementById('elevation'),
            elevationValue: document.getElementById('elevation-value'),
            windSpeed: document.getElementById('wind-speed'),
            windSpeedValue: document.getElementById('wind-speed-value'),
            windDirection: document.getElementById('wind-direction'),
            windDirectionValue: document.getElementById('wind-direction-value'),
            temperature: document.getElementById('temperature'),
            temperatureValue: document.getElementById('temperature-value'),
            humidity: document.getElementById('humidity'),
            humidityValue: document.getElementById('humidity-value'),
            
            // 目标参数
            targetType: document.getElementById('target-type'),
            targetTypeValue: document.getElementById('target-type-value'),
            targetLatitude: document.getElementById('target-latitude'),
            targetLatitudeValue: document.getElementById('target-latitude-value'),
            targetLongitude: document.getElementById('target-longitude'),
            targetLongitudeValue: document.getElementById('target-longitude-value'),
            targetElevation: document.getElementById('target-elevation'),
            targetElevationValue: document.getElementById('target-elevation-value'),
            targetSpeed: document.getElementById('target-speed'),
            targetSpeedValue: document.getElementById('target-speed-value'),
            targetDirection: document.getElementById('target-direction'),
            targetDirectionValue: document.getElementById('target-direction-value'),
            targetSpeedContainer: document.getElementById('target-speed-container'),
            targetDirectionContainer: document.getElementById('target-direction-container'),
            
            // 导弹参数
            missileTypeSelect: document.getElementById('missile-type-select'),
            missileTypeValue: document.getElementById('missile-type-value'),
            warheadType: document.getElementById('warhead-type'),
            warheadTypeValue: document.getElementById('warhead-type-value'),
            launchAngle: document.getElementById('launch-angle'),
            launchAngleValue: document.getElementById('launch-angle-value'),
            initialSpeed: document.getElementById('initial-speed'),
            initialSpeedValue: document.getElementById('initial-speed-value'),
            
            // 发射控制
            armMissile: document.getElementById('arm-missile'),
            launchMissile: document.getElementById('launch-missile'),
            countdownDisplay: document.getElementById('countdown-display'),
            launchStatus: document.getElementById('launch-status'),
            statusIcon: document.getElementById('status-icon'),
            statusText: document.getElementById('status-text'),
            
            // 模拟区域
            simulationArea: document.getElementById('simulation-area'),
            missile: document.getElementById('missile'),
            flame: document.getElementById('flame'),
            trajectory: document.getElementById('trajectory'),
            target: document.getElementById('target'),
            
            // 数据显示
            flightTime: document.getElementById('flight-time'),
            maxAltitude: document.getElementById('max-altitude'),
            range: document.getElementById('range'),
            hitProbability: document.getElementById('hit-probability'),
            
            // 雷达显示
            radarMode: document.getElementById('radar-mode'),
            radarTarget: document.getElementById('radar-target'),
            radarMissile: document.getElementById('radar-missile'),
            
            // 系统状态
            systemTime: document.getElementById('system-time'),
            systemLoad: document.getElementById('system-load'),
            loadPercentage: document.getElementById('load-percentage'),
            missileStatus: document.getElementById('missile-status'),
            launchPosition: document.getElementById('launch-position'),
            targetStatus: document.getElementById('target-status'),
            targetPosition: document.getElementById('target-position'),
            operationMode: document.getElementById('operation-mode'),
            
            // 按钮
            resetEnvironment: document.getElementById('reset-environment'),
            resetTarget: document.getElementById('reset-target'),
            resetMissile: document.getElementById('reset-missile'),
            calculateTrajectory: document.getElementById('calculate-trajectory'),
            clearSimulation: document.getElementById('clear-simulation'),
            showAltitude: document.getElementById('show-altitude'),
            showDistance: document.getElementById('show-distance'),
            generateReport: document.getElementById('generate-report'),
            helpButton: document.getElementById('help-button'),
            closeHelp: document.getElementById('close-help'),
            closeReport: document.getElementById('close-report'),
            printReport: document.getElementById('print-report'),
            downloadReport: document.getElementById('download-report'),
            
            // 模态框
            helpModal: document.getElementById('help-modal'),
            reportModal: document.getElementById('report-modal'),
            reportContent: document.getElementById('report-content')
        };

        // 图表对象
        let trajectoryChart;
        let impactChart;

        // 初始化函数
        function initialize() {
            // 初始化环境参数事件监听
            setupEnvironmentEventListeners();
            
            // 初始化目标参数事件监听
            setupTargetEventListeners();
            
            // 初始化导弹参数事件监听
            setupMissileEventListeners();
            
            // 初始化发射控制事件监听
            setupLaunchControlEventListeners();
            
            // 初始化按钮事件监听
            setupButtonEventListeners();
            
            // 初始化图表
            initializeCharts();
            
            // 初始化系统时间
            updateSystemTime();
            setInterval(updateSystemTime, 1000);
            
            // 模拟系统负载变化
            simulateSystemLoad();
            
            // 初始化目标显示
            updateTargetDisplay();
        }

        // 设置环境参数事件监听
        function setupEnvironmentEventListeners() {
            elements.terrainType.addEventListener('change', function() {
                systemData.environment.terrain = this.value;
                elements.terrainValue.textContent = getTerrainName(this.value);
                updateSimulation();
            });
            
            elements.elevation.addEventListener('input', function() {
                systemData.environment.elevation = parseInt(this.value);
                elements.elevationValue.textContent = this.value;
                updateSimulation();
            });
            
            elements.windSpeed.addEventListener('input', function() {
                systemData.environment.windSpeed = parseInt(this.value);
                elements.windSpeedValue.textContent = this.value;
                updateSimulation();
            });
            
            elements.windDirection.addEventListener('input', function() {
                systemData.environment.windDirection = parseInt(this.value);
                elements.windDirectionValue.textContent = this.value;
                updateSimulation();
            });
            
            elements.temperature.addEventListener('input', function() {
                systemData.environment.temperature = parseInt(this.value);
                elements.temperatureValue.textContent = this.value;
                updateSimulation();
            });
            
            elements.humidity.addEventListener('input', function() {
                systemData.environment.humidity = parseInt(this.value);
                elements.humidityValue.textContent = this.value;
                updateSimulation();
            });
        }

        // 设置目标参数事件监听
        function setupTargetEventListeners() {
            elements.targetType.addEventListener('change', function() {
                systemData.target.type = this.value;
                elements.targetTypeValue.textContent = getTargetTypeName(this.value);
                
                // 显示或隐藏移动参数
                if (this.value === 'moving') {
                    elements.targetSpeedContainer.classList.remove('hidden');
                    elements.targetDirectionContainer.classList.remove('hidden');
                } else {
                    elements.targetSpeedContainer.classList.add('hidden');
                    elements.targetDirectionContainer.classList.add('hidden');
                }
                
                updateTargetDisplay();
                updateSimulation();
            });
            
            elements.targetLatitude.addEventListener('input', function() {
                systemData.target.coordinates.latitude = parseFloat(this.value);
                elements.targetLatitudeValue.textContent = this.value;
                elements.targetPosition.textContent = `北纬 ${systemData.target.coordinates.latitude.toFixed(4)}° 东经 ${systemData.target.coordinates.longitude.toFixed(4)}°`;
                updateTargetDisplay();
                updateSimulation();
            });
            
            elements.targetLongitude.addEventListener('input', function() {
                systemData.target.coordinates.longitude = parseFloat(this.value);
                elements.targetLongitudeValue.textContent = this.value;
                elements.targetPosition.textContent = `北纬 ${systemData.target.coordinates.latitude.toFixed(4)}° 东经 ${systemData.target.coordinates.longitude.toFixed(4)}°`;
                updateTargetDisplay();
                updateSimulation();
            });
            
            elements.targetElevation.addEventListener('input', function() {
                systemData.target.coordinates.elevation = parseInt(this.value);
                elements.targetElevationValue.textContent = this.value;
                updateTargetDisplay();
                updateSimulation();
            });
            
            elements.targetSpeed.addEventListener('input', function() {
                systemData.target.movement.speed = parseInt(this.value);
                elements.targetSpeedValue.textContent = this.value;
                updateSimulation();
            });
            
            elements.targetDirection.addEventListener('input', function() {
                systemData.target.movement.direction = parseInt(this.value);
                elements.targetDirectionValue.textContent = this.value;
                updateSimulation();
            });
        }

        // 设置导弹参数事件监听
        function setupMissileEventListeners() {
            elements.missileTypeSelect.addEventListener('change', function() {
                systemData.missile.type = this.value;
                systemData.missile.typeName = this.options[this.selectedIndex].text;
                elements.missileTypeValue.textContent = this.options[this.selectedIndex].text;
                
                // 更新初始速度为导弹默认速度
                const defaultSpeed = systemData.missile.specifications[this.value].speed;
                systemData.missile.initialSpeed = defaultSpeed;
                elements.initialSpeed.value = defaultSpeed;
                elements.initialSpeedValue.textContent = defaultSpeed;
                
                // 更新可用的弹头类型
                updateWarheadOptions();
                
                updateSimulation();
            });
            
            elements.warheadType.addEventListener('change', function() {
                systemData.missile.warhead = this.value;
                elements.warheadTypeValue.textContent = getWarheadTypeName(this.value);
                updateSimulation();
            });
            
            elements.launchAngle.addEventListener('input', function() {
                systemData.missile.launchAngle = parseInt(this.value);
                elements.launchAngleValue.textContent = this.value;
                updateSimulation();
            });
            
            elements.initialSpeed.addEventListener('input', function() {
                systemData.missile.initialSpeed = parseInt(this.value);
                elements.initialSpeedValue.textContent = this.value;
                updateSimulation();
            });
        }

        // 设置发射控制事件监听
        function setupLaunchControlEventListeners() {
            elements.armMissile.addEventListener('click', function() {
                if (systemData.launch.status === 'ready') {
                    armMissile();
                } else if (systemData.launch.status === 'armed') {
                    disarmMissile();
                }
            });
            
            elements.launchMissile.addEventListener('click', function() {
                if (systemData.launch.status === 'armed' && !systemData.launch.isCountingDown) {
                    startCountdown();
                }
            });
            
            elements.radarMode.addEventListener('change', function() {
                updateRadarDisplay();
            });
            
            elements.operationMode.addEventListener('change', function() {
                systemData.system.mode = this.value;
                updateSystemMode();
            });
        }

        // 设置按钮事件监听
        function setupButtonEventListeners() {
            elements.resetEnvironment.addEventListener('click', resetEnvironment);
            elements.resetTarget.addEventListener('click', resetTarget);
            elements.resetMissile.addEventListener('click', resetMissile);
            elements.calculateTrajectory.addEventListener('click', calculateTrajectory);
            elements.clearSimulation.addEventListener('click', clearSimulation);
            elements.showAltitude.addEventListener('click', function() {
                showAltitudeChart();
                this.classList.add('bg-info/20', 'text-info');
                this.classList.remove('bg-dark', 'text-gray-300');
                elements.showDistance.classList.add('bg-dark', 'text-gray-300');
                elements.showDistance.classList.remove('bg-info/20', 'text-info');
            });
            elements.showDistance.addEventListener('click', function() {
                showDistanceChart();
                this.classList.add('bg-info/20', 'text-info');
                this.classList.remove('bg-dark', 'text-gray-300');
                elements.showAltitude.classList.add('bg-dark', 'text-gray-300');
                elements.showAltitude.classList.remove('bg-info/20', 'text-info');
            });
            elements.generateReport.addEventListener('click', generateReport);
            
            // 帮助模态框
            elements.helpButton.addEventListener('click', function() {
                elements.helpModal.classList.remove('hidden');
            });
            
            elements.closeHelp.addEventListener('click', function() {
                elements.helpModal.classList.add('hidden');
            });
            
            // 报告模态框
            elements.closeReport.addEventListener('click', function() {
                elements.reportModal.classList.add('hidden');
            });
            
            elements.printReport.addEventListener('click', function() {
                printReport();
            });
            
            elements.downloadReport.addEventListener('click', function() {
                downloadReport();
            });
        }

        // 初始化图表
        function initializeCharts() {
            // 弹道轨迹图表
            const trajectoryCtx = document.getElementById('trajectory-chart').getContext('2d');
            trajectoryChart = new Chart(trajectoryCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: '高度 (km)',
                        data: [],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: '时间 (秒)',
                                color: '#94a3b8'
                            },
                            ticks: {
                                color: '#94a3b8'
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: '高度 (km)',
                                color: '#94a3b8'
                            },
                            ticks: {
                                color: '#94a3b8'
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.1)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: '#e2e8f0'
                            }
                        }
                    }
                }
            });
            
            // 参数影响分析图表
            const impactCtx = document.getElementById('impact-chart').getContext('2d');
            impactChart = new Chart(impactCtx, {
                type: 'radar',
                data: {
                    labels: ['风速影响', '温度影响', '湿度影响', '海拔影响', '地形影响', '目标移动影响'],
                    datasets: [{
                        label: '影响程度',
                        data: [0, 0, 0, 0, 0, 0],
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: '#3b82f6',
                        borderWidth: 2,
                        pointBackgroundColor: '#3b82f6',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: {
                                color: 'rgba(148, 163, 184, 0.2)'
                            },
                            grid: {
                                color: 'rgba(148, 163, 184, 0.2)'
                            },
                            pointLabels: {
                                color: '#94a3b8'
                            },
                            ticks: {
                                color: '#94a3b8',
                                backdropColor: 'transparent'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            labels: {
                                color: '#e2e8f0'
                            }
                        }
                    }
                }
            });
        }

        // 更新系统时间
        function updateSystemTime() {
            systemData.system.time = new Date();
            const timeString = systemData.system.time.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            elements.systemTime.textContent = timeString;
        }

        // 模拟系统负载变化
        function simulateSystemLoad() {
            setInterval(() => {
                // 随机变化系统负载
                const change = Math.floor(Math.random() * 11) - 5; // -5 到 5 的随机数
                systemData.system.load = Math.max(5, Math.min(95, systemData.system.load + change));
                
                // 更新显示
                elements.systemLoad.style.width = `${systemData.system.load}%`;
                elements.loadPercentage.textContent = `${systemData.system.load}%`;
                
                // 根据负载改变颜色
                if (systemData.system.load < 30) {
                    elements.systemLoad.className = 'h-full bg-success';
                } else if (systemData.system.load < 70) {
                    elements.systemLoad.className = 'h-full bg-warning';
                } else {
                    elements.systemLoad.className = 'h-full bg-danger';
                }
            }, 5000);
        }

        // 更新目标显示
        function updateTargetDisplay() {
            // 显示目标
            elements.target.classList.remove('hidden');
            
            // 计算目标在模拟区域中的位置
            const simulationWidth = elements.simulationArea.offsetWidth;
            const simulationHeight = elements.simulationArea.offsetHeight;
            
            // 简化的坐标转换，实际应用中应该使用更复杂的地图投影算法
            const latRatio = (systemData.target.coordinates.latitude + 90) / 180;
            const lonRatio = (systemData.target.coordinates.longitude + 180) / 360;
            
            // 目标位置（从左上角开始计算）
            const targetX = lonRatio * simulationWidth;
            const targetY = latRatio * simulationHeight;
            
            // 设置目标位置
            elements.target.style.left = `${targetX}px`;
            elements.target.style.top = `${targetY}px`;
            
            // 更新雷达目标位置
            updateRadarTargetPosition(latRatio, lonRatio);
        }

        // 更新雷达目标位置
        function updateRadarTargetPosition(latRatio, lonRatio) {
            elements.radarTarget.style.left = `${lonRatio * 100}%`;
            elements.radarTarget.style.top = `${latRatio * 100}%`;
        }

        // 更新雷达导弹位置
        function updateRadarMissilePosition(latRatio, lonRatio) {
            elements.radarMissile.style.left = `${lonRatio * 100}%`;
            elements.radarMissile.style.top = `${latRatio * 100}%`;
        }

        // 更新雷达显示
        function updateRadarDisplay() {
            const mode = elements.radarMode.value;
            
            if (mode === 'active') {
                elements.radarTarget.classList.remove('hidden');
                elements.radarMissile.classList.remove('hidden');
            } else {
                elements.radarTarget.classList.add('hidden');
                elements.radarMissile.classList.add('hidden');
            }
        }

        // 更新系统模式
        function updateSystemMode() {
            const mode = systemData.system.mode;
            
            switch (mode) {
                case 'simulation':
                    // 模拟模式：所有功能可用
                    enableAllControls();
                    break;
                case 'training':
                    // 训练模式：部分功能限制
                    enableAllControls();
                    break;
                case 'test':
                    // 测试模式：仅查看数据，无法修改参数或发射
                    disableAllControls();
                    break;
            }
        }

        // 启用所有控制
        function enableAllControls() {
            // 环境参数
            elements.terrainType.disabled = false;
            elements.elevation.disabled = false;
            elements.windSpeed.disabled = false;
            elements.windDirection.disabled = false;
            elements.temperature.disabled = false;
            elements.humidity.disabled = false;
            
            // 目标参数
            elements.targetType.disabled = false;
            elements.targetLatitude.disabled = false;
            elements.targetLongitude.disabled = false;
            elements.targetElevation.disabled = false;
            elements.targetSpeed.disabled = false;
            elements.targetDirection.disabled = false;
            
            // 导弹参数
            elements.missileTypeSelect.disabled = false;
            elements.warheadType.disabled = false;
            elements.launchAngle.disabled = false;
            elements.initialSpeed.disabled = false;
            
            // 按钮
            elements.armMissile.disabled = false;
            elements.calculateTrajectory.disabled = false;
            elements.clearSimulation.disabled = false;
            elements.generateReport.disabled = false;
        }

        // 禁用所有控制
        function disableAllControls() {
            // 环境参数
            elements.terrainType.disabled = true;
            elements.elevation.disabled = true;
            elements.windSpeed.disabled = true;
            elements.windDirection.disabled = true;
            elements.temperature.disabled = true;
            elements.humidity.disabled = true;
            
            // 目标参数
            elements.targetType.disabled = true;
            elements.targetLatitude.disabled = true;
            elements.targetLongitude.disabled = true;
            elements.targetElevation.disabled = true;
            elements.targetSpeed.disabled = true;
            elements.targetDirection.disabled = true;
            
            // 导弹参数
            elements.missileTypeSelect.disabled = true;
            elements.warheadType.disabled = true;
            elements.launchAngle.disabled = true;
            elements.initialSpeed.disabled = true;
            
            // 按钮
            elements.armMissile.disabled = true;
            elements.launchMissile.disabled = true;
            elements.calculateTrajectory.disabled = true;
            elements.clearSimulation.disabled = true;
            elements.generateReport.disabled = false; // 报告功能仍可用
        }

        // 更新弹头选项
        function updateWarheadOptions() {
            const missileType = systemData.missile.type;
            const availableWarheads = systemData.missile.specifications[missileType].warheadTypes;
            
            // 清空现有选项
            elements.warheadType.innerHTML = '';
            
            // 添加可用的弹头类型
            availableWarheads.forEach(warhead => {
                const option = document.createElement('option');
                option.value = warhead;
                option.textContent = getWarheadTypeName(warhead);
                elements.warheadType.appendChild(option);
            });
            
            // 更新当前选择
            if (availableWarheads.includes(systemData.missile.warhead)) {
                elements.warheadType.value = systemData.missile.warhead;
            } else {
                systemData.missile.warhead = availableWarheads[0];
                elements.warheadType.value = availableWarheads[0];
            }
            
            elements.warheadTypeValue.textContent = getWarheadTypeName(systemData.missile.warhead);
        }

        // 更新模拟
        function updateSimulation() {
            if (systemData.launch.trajectoryCalculated) {
                calculateTrajectory();
            }
            
            // 更新参数影响分析
            updateImpactAnalysis();
        }

        // 计算弹道
        function calculateTrajectory() {
            // 显示计算中状态
            updateLaunchStatus('calculating', '正在计算弹道...', 'fa-calculator', 'text-info');
            
            // 模拟计算延迟
            setTimeout(() => {
                // 清空之前的轨迹
                elements.trajectory.innerHTML = '';
                systemData.simulation.trajectoryPoints = [];
                
                // 获取参数
                const launchAngle = systemData.missile.launchAngle * Math.PI / 180; // 转换为弧度
                const initialSpeed = systemData.missile.initialSpeed;
                const launchElevation = systemData.environment.elevation;
                const targetElevation = systemData.target.coordinates.elevation;
                
                // 计算初始速度分量
                const vx = initialSpeed * Math.cos(launchAngle);
                const vy = initialSpeed * Math.sin(launchAngle);
                
                // 物理常数
                const g = 9.8; // 重力加速度 (m/s^2)
                const airResistanceFactor = 0.00005; // 空气阻力系数
                
                // 计算时间步长
                const timeStep = 0.1;
                let time = 0;
                
                // 当前位置和速度
                let x = 0;
                let y = launchElevation;
                let vxCurrent = vx;
                let vyCurrent = vy;
                
                // 最大高度
                let maxAltitude = y;
                
                // 模拟弹道
                while (y >= targetElevation && time < 1000) { // 限制最大模拟时间
                    // 计算空气阻力
                    const speed = Math.sqrt(vxCurrent * vxCurrent + vyCurrent * vyCurrent);
                    const airResistance = airResistanceFactor * speed * speed;
                    
                    // 计算空气阻力分量
                    const airResistanceX = airResistance * (vxCurrent / speed) * -1;
                    const airResistanceY = airResistance * (vyCurrent / speed) * -1;
                    
                    // 计算风力影响
                    const windSpeed = systemData.environment.windSpeed;
                    const windDirection = systemData.environment.windDirection * Math.PI / 180; // 转换为弧度
                    const windEffectX = windSpeed * Math.cos(windDirection) * 0.1;
                    const windEffectY = windSpeed * Math.sin(windDirection) * 0.1;
                    
                    // 更新速度
                    vxCurrent += (airResistanceX + windEffectX) * timeStep;
                    vyCurrent += (-g + airResistanceY + windEffectY) * timeStep;
                    
                    // 更新位置
                    x += vxCurrent * timeStep;
                    y += vyCurrent * timeStep;
                    
                    // 更新最大高度
                    if (y > maxAltitude) {
                        maxAltitude = y;
                    }
                    
                    // 记录轨迹点
                    systemData.simulation.trajectoryPoints.push({
                        time: time,
                        x: x,
                        y: y,
                        altitude: y - launchElevation
                    });
                    
                    // 更新时间
                    time += timeStep;
                }
                
                // 计算射程（水平距离）
                const range = x;
                
                // 计算飞行时间
                const flightTime = time;
                
                // 计算弹着点
                systemData.simulation.impactPoint = {
                    x: x,
                    y: y
                };
                
                // 更新模拟数据
                systemData.simulation.flightTime = flightTime;
                systemData.simulation.maxAltitude = maxAltitude;
                systemData.simulation.range = range;
                
                // 计算命中率
                calculateHitProbability();
                
                // 更新显示
                updateDataDisplay();
                updateTrajectoryDisplay();
                updateTrajectoryChart();
                
                // 更新状态
                systemData.launch.trajectoryCalculated = true;
                updateLaunchStatus('ready', '弹道计算完成，等待发射指令', 'fa-check-circle', 'text-success');
                
            }, 1000); // 1秒延迟模拟计算过程
        }

        // 计算命中率
        function calculateHitProbability() {
            // 获取参数
            const missileType = systemData.missile.type;
            const missileAccuracy = systemData.missile.specifications[missileType].accuracy;
            const targetType = systemData.target.type;
            const windSpeed = systemData.environment.windSpeed;
            const temperature = systemData.environment.temperature;
            const humidity = systemData.environment.humidity;
            const elevation = systemData.environment.elevation;
            const terrain = systemData.environment.terrain;
            
            // 基础命中率（基于导弹精度）
            let baseProbability = 90 - (missileAccuracy / 10);
            
            // 目标类型影响
            switch (targetType) {
                case 'fixed':
                    baseProbability += 5; // 固定目标更容易命中
                    break;
                case 'moving':
                    baseProbability -= 10; // 移动目标更难命中
                    break;
                case 'high-value':
                    baseProbability -= 5; // 高价值目标可能有防御系统
                    break;
                case 'area':
                    baseProbability += 10; // 区域目标更容易命中
                    break;
            }
            
            // 环境因素影响
            // 风速影响
            const windEffect = Math.min(20, windSpeed * 2);
            baseProbability -= windEffect;
            
            // 温度影响
            const temperatureEffect = Math.min(10, Math.abs(temperature - 25) / 2);
            baseProbability -= temperatureEffect;
            
            // 湿度影响
            const humidityEffect = Math.min(5, Math.abs(humidity - 50) / 10);
            baseProbability -= humidityEffect;
            
            // 海拔影响
            const elevationEffect = Math.min(10, elevation / 500);
            baseProbability -= elevationEffect;
            
            // 地形影响
            switch (terrain) {
                case 'plain':
                    // 平原无影响
                    break;
                case 'mountain':
                    baseProbability -= 5; // 山地影响较大
                    break;
                case 'desert':
                    baseProbability -= 3; // 沙漠有一定影响
                    break;
                case 'ocean':
                    baseProbability += 2; // 海洋影响较小
                    break;
                case 'forest':
                    baseProbability -= 4; // 森林有一定影响
                    break;
            }
            
            // 确保命中率在0-100之间
            systemData.simulation.hitProbability = Math.max(0, Math.min(100, baseProbability));
        }

        // 更新数据显示
        function updateDataDisplay() {
            // 飞行时间
            const flightTime = systemData.simulation.flightTime;
            const hours = Math.floor(flightTime / 3600);
            const minutes = Math.floor((flightTime % 3600) / 60);
            const seconds = Math.floor(flightTime % 60);
            elements.flightTime.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // 最大高度
            elements.maxAltitude.textContent = `${(systemData.simulation.maxAltitude / 1000).toFixed(2)} km`;
            
            // 射程
            elements.range.textContent = `${(systemData.simulation.range / 1000).toFixed(2)} km`;
            
            // 命中率
            elements.hitProbability.textContent = `${systemData.simulation.hitProbability.toFixed(1)}%`;
            
            // 根据命中率设置颜色
            if (systemData.simulation.hitProbability >= 70) {
                elements.hitProbability.className = 'text-xl font-bold text-success parameter-value';
            } else if (systemData.simulation.hitProbability >= 40) {
                elements.hitProbability.className = 'text-xl font-bold text-warning parameter-value';
            } else {
                elements.hitProbability.className = 'text-xl font-bold text-danger parameter-value';
            }
        }

        // 更新轨迹显示
        function updateTrajectoryDisplay() {
            if (systemData.simulation.trajectoryPoints.length === 0) return;
            
            const simulationWidth = elements.simulationArea.offsetWidth;
            const simulationHeight = elements.simulationArea.offsetHeight;
            
            // 计算最大X和Y值，用于缩放
            const maxX = Math.max(...systemData.simulation.trajectoryPoints.map(point => point.x));
            const maxY = Math.max(...systemData.simulation.trajectoryPoints.map(point => point.y));
            
            // 创建SVG路径
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            path.setAttribute('width', '100%');
            path.setAttribute('height', '100%');
            path.style.position = 'absolute';
            path.style.top = '0';
            path.style.left = '0';
            path.style.pointerEvents = 'none';
            
            const polyline = document.createElementNS('http://www.w3.org/2000/svg', 'polyline');
            polyline.setAttribute('stroke', '#3b82f6');
            polyline.setAttribute('stroke-width', '2');
            polyline.setAttribute('fill', 'none');
            polyline.setAttribute('stroke-dasharray', '5,5');
            
            // 计算路径点
            const points = systemData.simulation.trajectoryPoints.map(point => {
                // 缩放X和Y坐标以适应模拟区域
                const x = (point.x / maxX) * simulationWidth;
                // Y坐标需要反转，因为SVG的原点在左上角
                const y = simulationHeight - (point.y / maxY) * simulationHeight;
                return `${x},${y}`;
            }).join(' ');
            
            polyline.setAttribute('points', points);
            path.appendChild(polyline);
            
            // 添加轨迹到模拟区域
            elements.trajectory.innerHTML = '';
            elements.trajectory.appendChild(path);
        }

        // 更新轨迹图表
        function updateTrajectoryChart() {
            if (systemData.simulation.trajectoryPoints.length === 0) return;
            
            // 准备数据
            const times = systemData.simulation.trajectoryPoints.map(point => point.time.toFixed(1));
            const altitudes = systemData.simulation.trajectoryPoints.map(point => (point.altitude / 1000).toFixed(2));
            const distances = systemData.simulation.trajectoryPoints.map(point => (point.x / 1000).toFixed(2));
            
            // 更新图表数据
            trajectoryChart.data.labels = times;
            trajectoryChart.data.datasets[0].data = altitudes;
            trajectoryChart.data.datasets[0].label = '高度 (km)';
            
            // 添加距离数据集（初始隐藏）
            if (trajectoryChart.data.datasets.length < 2) {
                trajectoryChart.data.datasets.push({
                    label: '距离 (km)',
                    data: distances,
                    borderColor: '#10b981',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    borderWidth: 2,
                    tension: 0.4,
                    fill: true,
                    hidden: true
                });
            } else {
                trajectoryChart.data.datasets[1].data = distances;
            }
            
            // 更新图表
            trajectoryChart.update();
        }

        // 显示高度图表
        function showAltitudeChart() {
            if (trajectoryChart.data.datasets.length < 2) return;
            
            trajectoryChart.data.datasets[0].hidden = false;
            trajectoryChart.data.datasets[1].hidden = true;
            trajectoryChart.options.scales.y.title.text = '高度 (km)';
            trajectoryChart.update();
        }

        // 显示距离图表
        function showDistanceChart() {
            if (trajectoryChart.data.datasets.length < 2) return;
            
            trajectoryChart.data.datasets[0].hidden = true;
            trajectoryChart.data.datasets[1].hidden = false;
            trajectoryChart.options.scales.y.title.text = '距离 (km)';
            trajectoryChart.update();
        }

        // 更新参数影响分析
        function updateImpactAnalysis() {
            // 获取参数
            const windSpeed = systemData.environment.windSpeed;
            const temperature = systemData.environment.temperature;
            const humidity = systemData.environment.humidity;
            const elevation = systemData.environment.elevation;
            const terrain = systemData.environment.terrain;
            const targetType = systemData.target.type;
            
            // 计算各参数影响程度（0-100）
            const windImpact = Math.min(100, (windSpeed / 30) * 100);
            const temperatureImpact = Math.min(100, (Math.abs(temperature - 25) / 75) * 100);
            const humidityImpact = Math.min(100, (Math.abs(humidity - 50) / 100) * 100);
            const elevationImpact = Math.min(100, (elevation / 5000) * 100);
            
            // 地形影响
            let terrainImpact = 0;
            switch (terrain) {
                case 'plain':
                    terrainImpact = 10;
                    break;
                case 'mountain':
                    terrainImpact = 70;
                    break;
                case 'desert':
                    terrainImpact = 40;
                    break;
                case 'ocean':
                    terrainImpact = 20;
                    break;
                case 'forest':
                    terrainImpact = 50;
                    break;
            }
            
            // 目标移动影响
            let targetMovementImpact = 0;
            if (targetType === 'moving') {
                const targetSpeed = systemData.target.movement.speed;
                targetMovementImpact = Math.min(100, (targetSpeed / 100) * 100);
            }
            
            // 更新雷达图数据
            impactChart.data.datasets[0].data = [
                windImpact,
                temperatureImpact,
                humidityImpact,
                elevationImpact,
                terrainImpact,
                targetMovementImpact
            ];
            
            // 更新图表
            impactChart.update();
        }

        // 武器解除保险
        function armMissile() {
            if (!systemData.launch.trajectoryCalculated) {
                alert('请先计算弹道！');
                return;
            }
            
            systemData.launch.status = 'armed';
            elements.armMissile.innerHTML = '<i class="fa fa-unlock mr-1"></i> 武器已解除保险';
            elements.armMissile.classList.remove('bg-warning/20', 'hover:bg-warning/30', 'text-warning');
            elements.armMissile.classList.add('bg-danger/20', 'hover:bg-danger/30', 'text-danger');
            
            // 启用发射按钮
            elements.launchMissile.disabled = false;
            
            // 更新状态
            updateLaunchStatus('armed', '武器已解除保险，准备发射', 'fa-exclamation-triangle', 'text-warning');
        }

        // 武器上保险
        function disarmMissile() {
            systemData.launch.status = 'ready';
            elements.armMissile.innerHTML = '<i class="fa fa-lock mr-1"></i> 武器解除保险';
            elements.armMissile.classList.remove('bg-danger/20', 'hover:bg-danger/30', 'text-danger');
            elements.armMissile.classList.add('bg-warning/20', 'hover:bg-warning/30', 'text-warning');
            
            // 禁用发射按钮
            elements.launchMissile.disabled = true;
            
            // 停止倒计时（如果正在进行）
            if (systemData.launch.isCountingDown) {
                stopCountdown();
            }
            
            // 更新状态
            updateLaunchStatus('ready', '武器已上保险，等待发射指令', 'fa-check-circle', 'text-success');
        }

        // 开始倒计时
        function startCountdown() {
            systemData.launch.isCountingDown = true;
            systemData.launch.countdown = 10; // 10秒倒计时
            
            // 更新倒计时显示
            updateCountdownDisplay();
            
            // 更新状态
            updateLaunchStatus('counting', '发射倒计时开始', 'fa-clock-o', 'text-warning');
            
            // 设置倒计时定时器
            systemData.launch.countdownInterval = setInterval(() => {
                systemData.launch.countdown--;
                
                // 更新倒计时显示
                updateCountdownDisplay();
                
                // 倒计时结束
                if (systemData.launch.countdown <= 0) {
                    stopCountdown();
                    launchMissile();
                }
            }, 1000);
        }

        // 停止倒计时
        function stopCountdown() {
            clearInterval(systemData.launch.countdownInterval);
            systemData.launch.isCountingDown = false;
        }

        // 更新倒计时显示
        function updateCountdownDisplay() {
            const countdown = systemData.launch.countdown;
            const seconds = countdown % 60;
            const minutes = Math.floor(countdown / 60) % 60;
            const hours = Math.floor(countdown / 3600);
            
            // 格式化数字
            const formattedHours = hours.toString().padStart(2, '0');
            const formattedMinutes = minutes.toString().padStart(2, '0');
            const formattedSeconds = seconds.toString().padStart(2, '0');
            
            // 更新显示
            updateDigitDisplay(0, formattedHours[0]);
            updateDigitDisplay(1, formattedHours[1]);
            updateDigitDisplay(2, formattedMinutes[0]);
            updateDigitDisplay(3, formattedMinutes[1]);
            updateDigitDisplay(4, formattedSeconds[0]);
            updateDigitDisplay(5, formattedSeconds[1]);
        }

        // 更新数字显示
        function updateDigitDisplay(index, digit) {
            const digits = elements.countdownDisplay.querySelectorAll('.display-digit');
            if (index >= digits.length) return;
            
            // 移除所有数字类
            digits[index].className = digits[index].className.replace(/display-digit-\d/, '');
            
            // 添加当前数字类
            digits[index].classList.add(`display-digit-${digit}`);
        }

        // 发射导弹
        function launchMissile() {
            systemData.launch.status = 'launching';
            systemData.launch.simulationRunning = true;
            
            // 更新状态
            updateLaunchStatus('launching', '导弹发射中...', 'fa-rocket', 'text-danger');
            
            // 禁用发射按钮
            elements.launchMissile.disabled = true;
            
            // 显示导弹和火焰
            elements.missile.classList.remove('hidden');
            elements.flame.classList.remove('hidden');
            
            // 开始导弹动画
            animateMissile();
        }

        // 导弹动画
        function animateMissile() {
            if (systemData.simulation.trajectoryPoints.length === 0) return;
            
            const simulationWidth = elements.simulationArea.offsetWidth;
            const simulationHeight = elements.simulationArea.offsetHeight;
            
            // 计算最大X和Y值，用于缩放
            const maxX = Math.max(...systemData.simulation.trajectoryPoints.map(point => point.x));
            const maxY = Math.max(...systemData.simulation.trajectoryPoints.map(point => point.y));
            
            // 动画参数
            let frameIndex = 0;
            const totalFrames = systemData.simulation.trajectoryPoints.length;
            const animationSpeed = 20; // 毫秒
            
            // 动画函数
            function animate() {
                if (frameIndex >= totalFrames || !systemData.launch.simulationRunning) {
                    // 动画结束
                    missileLaunched();
                    return;
                }
                
                // 获取当前帧的位置
                const point = systemData.simulation.trajectoryPoints[frameIndex];
                
                // 缩放X和Y坐标以适应模拟区域
                const x = (point.x / maxX) * simulationWidth;
                // Y坐标需要反转，因为CSS的原点在左上角
                const y = simulationHeight - (point.y / maxY) * simulationHeight;
                
                // 更新导弹位置
                elements.missile.style.left = `${x}px`;
                elements.missile.style.bottom = `${simulationHeight - y}px`;
                
                // 更新雷达导弹位置
                const latRatio = (90 - systemData.target.coordinates.latitude) / 180;
                const lonRatio = (systemData.target.coordinates.longitude + 180) / 360;
                updateRadarMissilePosition(latRatio, lonRatio);
                
                // 添加轨迹点
                addTrajectoryPoint(x, y);
                
                // 更新帧索引
                frameIndex++;
                
                // 继续动画
                setTimeout(animate, animationSpeed);
            }
            
            // 开始动画
            animate();
        }

        // 添加轨迹点
        function addTrajectoryPoint(x, y) {
            const point = document.createElement('div');
            point.className = 'absolute w-1 h-1 bg-blue-500 rounded-full';
            point.style.left = `${x}px`;
            point.style.top = `${y}px`;
            point.style.opacity = '0.7';
            
            // 添加到轨迹
            elements.trajectory.appendChild(point);
            
            // 淡出效果
            setTimeout(() => {
                point.style.opacity = '0';
                setTimeout(() => {
                    if (elements.trajectory.contains(point)) {
                        elements.trajectory.removeChild(point);
                    }
                }, 1000);
            }, 500);
        }

        // 导弹发射完成
        function missileLaunched() {
            systemData.launch.status = 'launched';
            
            // 隐藏火焰
            elements.flame.classList.add('hidden');
            
            // 更新状态
            updateLaunchStatus('launched', '导弹已发射，飞行中...', 'fa-paper-plane', 'text-info');
            
            // 模拟导弹命中目标
            setTimeout(() => {
                missileHitTarget();
            }, 2000);
        }

        // 导弹命中目标
        function missileHitTarget() {
            systemData.launch.status = 'completed';
            systemData.launch.simulationRunning = false;
            
            // 显示命中效果
            showHitEffect();
            
            // 更新状态
            const hitProbability = systemData.simulation.hitProbability;
            if (hitProbability >= 70) {
                updateLaunchStatus('completed', '目标命中！', 'fa-bullseye', 'text-success');
            } else if (hitProbability >= 40) {
                updateLaunchStatus('completed', '接近命中目标', 'fa-arrow-right', 'text-warning');
            } else {
                updateLaunchStatus('completed', '未命中目标', 'fa-times-circle', 'text-danger');
            }
            
            // 武器上保险
            disarmMissile();
        }

        // 显示命中效果
        function showHitEffect() {
            // 创建爆炸效果
            const explosion = document.createElement('div');
            explosion.className = 'absolute w-16 h-16 bg-yellow-500 rounded-full animate-ping';
            explosion.style.left = elements.target.style.left;
            explosion.style.top = elements.target.style.top;
            explosion.style.transform = 'translate(-50%, -50%)';
            explosion.style.zIndex = '10';
            
            // 添加到模拟区域
            elements.simulationArea.appendChild(explosion);
            
            // 添加震动效果
            elements.simulationArea.classList.add('animate-shake');
            
            // 移除效果
            setTimeout(() => {
                explosion.remove();
                elements.simulationArea.classList.remove('animate-shake');
            }, 2000);
        }

        // 更新发射状态
        function updateLaunchStatus(status, text, icon, colorClass) {
            systemData.launch.status = status;
            
            // 更新图标和文本
            elements.statusIcon.className = `fa ${icon} text-2xl ${colorClass}`;
            elements.statusText.textContent = text;
            
            // 更新导弹状态
            switch (status) {
                case 'ready':
                    elements.missileStatus.textContent = '就绪';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-success/20 text-success';
                    break;
                case 'armed':
                    elements.missileStatus.textContent = '已解除保险';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-warning/20 text-warning';
                    break;
                case 'counting':
                    elements.missileStatus.textContent = '发射倒计时';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-warning/20 text-warning';
                    break;
                case 'launching':
                    elements.missileStatus.textContent = '发射中';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-danger/20 text-danger';
                    break;
                case 'launched':
                    elements.missileStatus.textContent = '已发射';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-info/20 text-info';
                    break;
                case 'completed':
                    elements.missileStatus.textContent = '任务完成';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-success/20 text-success';
                    break;
                case 'failed':
                    elements.missileStatus.textContent = '任务失败';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-danger/20 text-danger';
                    break;
                case 'calculating':
                    elements.missileStatus.textContent = '计算中';
                    elements.missileStatus.className = 'text-xs px-2 py-0.5 rounded-full bg-info/20 text-info';
                    break;
            }
        }

        // 重置环境参数
        function resetEnvironment() {
            systemData.environment = {
                terrain: 'plain',
                elevation: 500,
                windSpeed: 5,
                windDirection: 90,
                temperature: 25,
                humidity: 50
            };
            
            // 更新UI
            elements.terrainType.value = systemData.environment.terrain;
            elements.terrainValue.textContent = getTerrainName(systemData.environment.terrain);
            elements.elevation.value = systemData.environment.elevation;
            elements.elevationValue.textContent = systemData.environment.elevation;
            elements.windSpeed.value = systemData.environment.windSpeed;
            elements.windSpeedValue.textContent = systemData.environment.windSpeed;
            elements.windDirection.value = systemData.environment.windDirection;
            elements.windDirectionValue.textContent = systemData.environment.windDirection;
            elements.temperature.value = systemData.environment.temperature;
            elements.temperatureValue.textContent = systemData.environment.temperature;
            elements.humidity.value = systemData.environment.humidity;
            elements.humidityValue.textContent = systemData.environment.humidity;
            
            // 更新模拟
            updateSimulation();
        }

        // 重置目标参数
        function resetTarget() {
            systemData.target = {
                type: 'fixed',
                coordinates: {
                    latitude: 35.6762,
                    longitude: 139.6503,
                    elevation: 100
                },
                movement: {
                    speed: 20,
                    direction: 45
                }
            };
            
            // 更新UI
            elements.targetType.value = systemData.target.type;
            elements.targetTypeValue.textContent = getTargetTypeName(systemData.target.type);
            elements.targetLatitude.value = systemData.target.coordinates.latitude;
            elements.targetLatitudeValue.textContent = systemData.target.coordinates.latitude;
            elements.targetLongitude.value = systemData.target.coordinates.longitude;
            elements.targetLongitudeValue.textContent = systemData.target.coordinates.longitude;
            elements.targetElevation.value = systemData.target.coordinates.elevation;
            elements.targetElevationValue.textContent = systemData.target.coordinates.elevation;
            elements.targetSpeed.value = systemData.target.movement.speed;
            elements.targetSpeedValue.textContent = systemData.target.movement.speed;
            elements.targetDirection.value = systemData.target.movement.direction;
            elements.targetDirectionValue.textContent = systemData.target.movement.direction;
            
            // 隐藏移动参数
            elements.targetSpeedContainer.classList.add('hidden');
            elements.targetDirectionContainer.classList.add('hidden');
            
            // 更新目标位置显示
            elements.targetPosition.textContent = `北纬 ${systemData.target.coordinates.latitude.toFixed(4)}° 东经 ${systemData.target.coordinates.longitude.toFixed(4)}°`;
            
            // 更新目标显示
            updateTargetDisplay();
            
            // 更新模拟
            updateSimulation();
        }

        // 重置导弹参数
        function resetMissile() {
            systemData.missile = {
                type: 'df-41',
                typeName: '东风-41 洲际弹道导弹',
                warhead: 'nuclear',
                launchAngle: 45,
                initialSpeed: 7000,
                specifications: systemData.missile.specifications // 保留规格数据
            };
            
            // 更新UI
            elements.missileTypeSelect.value = systemData.missile.type;
            elements.missileTypeValue.textContent = systemData.missile.typeName;
            elements.warheadType.value = systemData.missile.warhead;
            elements.warheadTypeValue.textContent = getWarheadTypeName(systemData.missile.warhead);
            elements.launchAngle.value = systemData.missile.launchAngle;
            elements.launchAngleValue.textContent = systemData.missile.launchAngle;
            elements.initialSpeed.value = systemData.missile.initialSpeed;
            elements.initialSpeedValue.textContent = systemData.missile.initialSpeed;
            
            // 更新弹头选项
            updateWarheadOptions();
            
            // 更新模拟
            updateSimulation();
        }

        // 清除模拟
        function clearSimulation() {
            // 停止任何正在进行的动画或倒计时
            if (systemData.launch.isCountingDown) {
                stopCountdown();
            }
            
            systemData.launch.simulationRunning = false;
            
            // 隐藏导弹和火焰
            elements.missile.classList.add('hidden');
            elements.flame.classList.add('hidden');
            
            // 清空轨迹
            elements.trajectory.innerHTML = '';
            
            // 重置状态
            systemData.launch.status = 'ready';
            systemData.launch.trajectoryCalculated = false;
            
            // 更新UI
            elements.armMissile.innerHTML = '<i class="fa fa-lock mr-1"></i> 武器解除保险';
            elements.armMissile.classList.remove('bg-danger/20', 'hover:bg-danger/30', 'text-danger');
            elements.armMissile.classList.add('bg-warning/20', 'hover:bg-warning/30', 'text-warning');
            
            // 禁用发射按钮
            elements.launchMissile.disabled = true;
            
            // 更新状态
            updateLaunchStatus('ready', '等待发射指令', 'fa-check-circle', 'text-success');
            
            // 重置倒计时显示
            updateDigitDisplay(0, '0');
            updateDigitDisplay(1, '0');
            updateDigitDisplay(2, '0');
            updateDigitDisplay(3, '0');
            updateDigitDisplay(4, '0');
            updateDigitDisplay(5, '0');
            
            // 重置数据显示
            elements.flightTime.textContent = '00:00:00';
            elements.maxAltitude.textContent = '0 km';
            elements.range.textContent = '0 km';
            elements.hitProbability.textContent = '0%';
            elements.hitProbability.className = 'text-xl font-bold text-success parameter-value';
            
            // 重置图表
            trajectoryChart.data.labels = [];
            trajectoryChart.data.datasets[0].data = [];
            if (trajectoryChart.data.datasets.length > 1) {
                trajectoryChart.data.datasets[1].data = [];
            }
            trajectoryChart.update();
            
            // 重置雷达导弹位置
            elements.radarMissile.style.left = '50%';
            elements.radarMissile.style.top = '50%';
        }

        // 生成报告
        function generateReport() {
            // 创建报告内容
            const reportHTML = `
                <div class="space-y-4">
                    <div class="text-center mb-6">
                        <h2 class="text-2xl font-bold text-shadow-lg mb-2">导弹发射模拟报告</h2>
                        <p class="text-gray-400">生成时间: ${systemData.system.time.toLocaleString('zh-CN')}</p>
                        <p class="text-gray-400">系统模式: ${getModeName(systemData.system.mode)}</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-dark rounded-lg p-4 border border-accent/30">
                            <h3 class="text-lg font-semibold text-accent mb-3">发射参数摘要</h3>
                            <table class="w-full text-sm">
                                <tr>
                                    <td class="py-1 text-gray-400">导弹类型:</td>
                                    <td class="py-1 font-medium">${systemData.missile.typeName}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">弹头类型:</td>
                                    <td class="py-1 font-medium">${getWarheadTypeName(systemData.missile.warhead)}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">发射位置:</td>
                                    <td class="py-1 font-medium">北纬 ${systemData.launch.position.latitude.toFixed(4)}° 东经 ${systemData.launch.position.longitude.toFixed(4)}°</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">目标位置:</td>
                                    <td class="py-1 font-medium">北纬 ${systemData.target.coordinates.latitude.toFixed(4)}° 东经 ${systemData.target.coordinates.longitude.toFixed(4)}°</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">发射角度:</td>
                                    <td class="py-1 font-medium">${systemData.missile.launchAngle}°</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">初始速度:</td>
                                    <td class="py-1 font-medium">${systemData.missile.initialSpeed} 米/秒</td>
                                </tr>
                            </table>
                        </div>
                        
                        <div class="bg-dark rounded-lg p-4 border border-accent/30">
                            <h3 class="text-lg font-semibold text-accent mb-3">模拟结果摘要</h3>
                            <table class="w-full text-sm">
                                <tr>
                                    <td class="py-1 text-gray-400">预计飞行时间:</td>
                                    <td class="py-1 font-medium">${elements.flightTime.textContent}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">预计最大高度:</td>
                                    <td class="py-1 font-medium">${elements.maxAltitude.textContent}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">预计射程:</td>
                                    <td class="py-1 font-medium">${elements.range.textContent}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">预计命中率:</td>
                                    <td class="py-1 font-medium ${systemData.simulation.hitProbability >= 70 ? 'text-success' : systemData.simulation.hitProbability >= 40 ? 'text-warning' : 'text-danger'}">${elements.hitProbability.textContent}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">环境条件影响:</td>
                                    <td class="py-1 font-medium">${getEnvironmentImpact()}</td>
                                </tr>
                                <tr>
                                    <td class="py-1 text-gray-400">任务状态:</td>
                                    <td class="py-1 font-medium ${systemData.launch.status === 'completed' ? 'text-success' : systemData.launch.status === 'failed' ? 'text-danger' : 'text-info'}">${getStatusName(systemData.launch.status)}</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                    <div class="bg-dark rounded-lg p-4 border border-accent/30 mb-6">
                        <h3 class="text-lg font-semibold text-accent mb-3">环境参数详情</h3>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <p class="text-sm text-gray-400 mb-1">地形类型</p>
                                <p class="font-medium">${getTerrainName(systemData.environment.terrain)}</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">海拔高度</p>
                                <p class="font-medium">${systemData.environment.elevation} 米</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">温度</p>
                                <p class="font-medium">${systemData.environment.temperature} °C</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">湿度</p>
                                <p class="font-medium">${systemData.environment.humidity} %</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">风速</p>
                                <p class="font-medium">${systemData.environment.windSpeed} 米/秒</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">风向</p>
                                <p class="font-medium">${systemData.environment.windDirection}°</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-dark rounded-lg p-4 border border-accent/30 mb-6">
                        <h3 class="text-lg font-semibold text-accent mb-3">导弹性能分析</h3>
                        <p class="text-gray-300 mb-3">${systemData.missile.specifications[systemData.missile.type].description}</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <p class="text-sm text-gray-400 mb-1">最大射程</p>
                                <p class="font-medium">${systemData.missile.specifications[systemData.missile.type].range} 公里</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">最大速度</p>
                                <p class="font-medium">${systemData.missile.specifications[systemData.missile.type].speed} 米/秒</p>
                            </div>
                            <div>
                                <p class="text-sm text-gray-400 mb-1">命中精度</p>
                                <p class="font-medium">${systemData.missile.specifications[systemData.missile.type].accuracy} 米</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-dark rounded-lg p-4 border border-accent/30">
                        <h3 class="text-lg font-semibold text-accent mb-3">参数影响分析</h3>
                        <p class="text-gray-300 mb-3">各环境参数对导弹发射的影响程度分析：</p>
                        <div class="h-64">
                            <canvas id="report-impact-chart"></canvas>
                        </div>
                    </div>
                </div>
            `;
            
            // 更新报告内容
            elements.reportContent.innerHTML = reportHTML;
            
            // 显示报告模态框
            elements.reportModal.classList.remove('hidden');
            
            // 初始化报告中的图表
            setTimeout(() => {
                const reportImpactCtx = document.getElementById('report-impact-chart').getContext('2d');
                new Chart(reportImpactCtx, {
                    type: 'radar',
                    data: impactChart.data,
                    options: impactChart.options
                });
            }, 100);
        }

        // 打印报告
        function printReport() {
            // 创建打印窗口
            const printWindow = window.open('', '_blank');
            
            // 获取报告内容
            const reportContent = elements.reportContent.innerHTML;
            
            // 设置打印内容
            printWindow.document.write(`
                <html>
                <head>
                    <title>导弹发射模拟报告</title>
                    <style>
                        body {
                            font-family: Arial, sans-serif;
                            background-color: white;
                            color: black;
                            padding: 20px;
                        }
                        .text-shadow {
                            text-shadow: none;
                        }
                        .text-shadow-lg {
                            text-shadow: none;
                        }
                        .bg-dark {
                            background-color: #f0f0f0;
                            padding: 10px;
                            border-radius: 5px;
                        }
                        .border {
                            border: 1px solid #ddd;
                        }
                        .text-accent {
                            color: #0066cc;
                        }
                        .text-success {
                            color: #00cc66;
                        }
                        .text-warning {
                            color: #ffcc00;
                        }
                        .text-danger {
                            color: #cc0000;
                        }
                        table {
                            width: 100%;
                            border-collapse: collapse;
                        }
                        td {
                            padding: 5px;
                        }
                        .grid {
                            display: grid;
                            grid-template-columns: repeat(2, 1fr);
                            gap: 20px;
                        }
                        @media print {
                            .no-print {
                                display: none;
                            }
                        }
                    </style>
                </head>
                <body>
                    ${reportContent}
                    <div class="no-print text-center mt-6">
                        <button onclick="window.print()">打印报告</button>
                        <button onclick="window.close()">关闭窗口</button>
                    </div>
                </body>
                </html>
            `);
            
            // 关闭文档
            printWindow.document.close();
            
            // 打印
            setTimeout(() => {
                printWindow.print();
            }, 500);
        }

        // 下载报告
        function downloadReport() {
            // 创建报告内容
            const reportText = `
导弹发射模拟报告
生成时间: ${systemData.system.time.toLocaleString('zh-CN')}
系统模式: ${getModeName(systemData.system.mode)}

发射参数摘要:
- 导弹类型: ${systemData.missile.typeName}
- 弹头类型: ${getWarheadTypeName(systemData.missile.warhead)}
- 发射位置: 北纬 ${systemData.launch.position.latitude.toFixed(4)}° 东经 ${systemData.launch.position.longitude.toFixed(4)}°
- 目标位置: 北纬 ${systemData.target.coordinates.latitude.toFixed(4)}° 东经 ${systemData.target.coordinates.longitude.toFixed(4)}°
- 发射角度: ${systemData.missile.launchAngle}°
- 初始速度: ${systemData.missile.initialSpeed} 米/秒

模拟结果摘要:
- 预计飞行时间: ${elements.flightTime.textContent}
- 预计最大高度: ${elements.maxAltitude.textContent}
- 预计射程: ${elements.range.textContent}
- 预计命中率: ${elements.hitProbability.textContent}
- 环境条件影响: ${getEnvironmentImpact()}
- 任务状态: ${getStatusName(systemData.launch.status)}

环境参数详情:
- 地形类型: ${getTerrainName(systemData.environment.terrain)}
- 海拔高度: ${systemData.environment.elevation} 米
- 温度: ${systemData.environment.temperature} °C
- 湿度: ${systemData.environment.humidity} %
- 风速: ${systemData.environment.windSpeed} 米/秒
- 风向: ${systemData.environment.windDirection}°

导弹性能分析:
${systemData.missile.specifications[systemData.missile.type].description}
- 最大射程: ${systemData.missile.specifications[systemData.missile.type].range} 公里
- 最大速度: ${systemData.missile.specifications[systemData.missile.type].speed} 米/秒
- 命中精度: ${systemData.missile.specifications[systemData.missile.type].accuracy} 米
            `;
            
            // 创建Blob对象
            const blob = new Blob([reportText], { type: 'text/plain' });
            
            // 创建下载链接
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `导弹发射模拟报告_${systemData.system.time.toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;
            
            // 触发下载
            document.body.appendChild(a);
            a.click();
            
            // 清理
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 0);
        }

        // 辅助函数：获取地形名称
        function getTerrainName(terrain) {
            const terrainNames = {
                'plain': '平原',
                'mountain': '山地',
                'desert': '沙漠',
                'ocean': '海洋',
                'forest': '森林'
            };
            return terrainNames[terrain] || terrain;
        }

        // 辅助函数：获取目标类型名称
        function getTargetTypeName(type) {
            const typeNames = {
                'fixed': '固定目标',
                'moving': '移动目标',
                'high-value': '高价值目标',
                'area': '区域目标'
            };
            return typeNames[type] || type;
        }

        // 辅助函数：获取弹头类型名称
        function getWarheadTypeName(type) {
            const typeNames = {
                'nuclear': '核弹头',
                'conventional': '常规弹头',
                'thermobaric': '温压弹头',
                'cluster': '集束弹头'
            };
            return typeNames[type] || type;
        }

        // 辅助函数：获取系统模式名称
        function getModeName(mode) {
            const modeNames = {
                'simulation': '模拟模式',
                'training': '训练模式',
                'test': '测试模式'
            };
            return modeNames[mode] || mode;
        }

        // 辅助函数：获取状态名称
        function getStatusName(status) {
            const statusNames = {
                'ready': '就绪',
                'armed': '已解除保险',
                'counting': '发射倒计时',
                'launching': '发射中',
                'launched': '已发射',
                'completed': '任务完成',
                'failed': '任务失败',
                'calculating': '计算中'
            };
            return statusNames[status] || status;
        }

        // 辅助函数：获取环境影响描述
        function getEnvironmentImpact() {
            const windSpeed = systemData.environment.windSpeed;
            const temperature = systemData.environment.temperature;
            const humidity = systemData.environment.humidity;
            const elevation = systemData.environment.elevation;
            const terrain = systemData.environment.terrain;
            
            // 计算综合影响指数
            let impactIndex = 0;
            
            // 风速影响
            if (windSpeed > 20) {
                impactIndex += 3;
            } else if (windSpeed > 10) {
                impactIndex += 2;
            } else if (windSpeed > 5) {
                impactIndex += 1;
            }
            
            // 温度影响
            if (Math.abs(temperature - 25) > 30) {
                impactIndex += 3;
            } else if (Math.abs(temperature - 25) > 20) {
                impactIndex += 2;
            } else if (Math.abs(temperature - 25) > 10) {
                impactIndex += 1;
            }
            
            // 湿度影响
            if (Math.abs(humidity - 50) > 60) {
                impactIndex += 2;
            } else if (Math.abs(humidity - 50) > 40) {
                impactIndex += 1;
            }
            
            // 海拔影响
            if (elevation > 3000) {
                impactIndex += 3;
            } else if (elevation > 1500) {
                impactIndex += 2;
            } else if (elevation > 500) {
                impactIndex += 1;
            }
            
            // 地形影响
            switch (terrain) {
                case 'mountain':
                    impactIndex += 3;
                    break;
                case 'forest':
                    impactIndex += 2;
                    break;
                case 'desert':
                    impactIndex += 1;
                    break;
            }
            
            // 根据影响指数返回描述
            if (impactIndex >= 10) {
                return '严重影响';
            } else if (impactIndex >= 7) {
                return '较大影响';
            } else if (impactIndex >= 4) {
                return '中等影响';
            } else if (impactIndex >= 2) {
                return '轻微影响';
            } else {
                return '影响较小';
            }
        }

        // 初始化系统
        window.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>